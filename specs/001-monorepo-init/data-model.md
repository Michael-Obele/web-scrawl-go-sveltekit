# Data Model: Monorepo Initialization

**Feature**: 001-monorepo-init  
**Date**: 2025-10-16  
**Status**: Complete

## Overview

This feature is **infrastructure-focused** and does not introduce persistent data models. However, it defines **runtime entities** and **configuration structures** that establish patterns for future features.

---

## Runtime Entities

### 1. Health Status

**Purpose**: Represents the backend service health state returned by the `/health` endpoint.

**Structure**:

```typescript
interface HealthStatus {
  status: "healthy" | "unhealthy";
  service: string;
  timestamp: number;
}
```

**Fields**:

- `status`: Service operational state (always "healthy" for MVP; future features may add "degraded")
- `service`: Service identifier for multi-service environments (e.g., "web-scraper-backend")
- `timestamp`: Unix timestamp of health check execution (enables uptime monitoring)

**Validation Rules**:

- `status` MUST be one of: "healthy", "unhealthy"
- `timestamp` MUST be a valid Unix epoch (seconds since 1970-01-01)
- `service` MUST be a non-empty string

**State Transitions**: N/A (stateless; computed on each request)

**Relationships**: None

**Usage**:

- **Backend**: Generated by `handlers/health.go` on each GET /health request
- **Frontend**: Consumed by SvelteKit server route, displayed on `/health` page

---

## Configuration Structures

### 2. CORS Configuration

**Purpose**: Defines allowed origins for cross-origin requests to the Go backend.

**Structure**:

```go
type CORSConfig struct {
    AllowOrigins     []string
    AllowMethods     []string
    AllowHeaders     []string
    AllowCredentials bool
}
```

**Fields**:

- `AllowOrigins`: List of permitted origins (e.g., `["http://localhost:5173"]`)
- `AllowMethods`: HTTP methods allowed (e.g., `["GET", "POST", "PUT", "DELETE"]`)
- `AllowHeaders`: Permitted request headers (e.g., `["Content-Type", "Authorization"]`)
- `AllowCredentials`: Whether to allow cookies/auth headers (default: `true`)

**Validation Rules**:

- `AllowOrigins` MUST NOT include wildcard "\*" in production
- Each origin MUST be a valid URL with protocol (http:// or https://)
- `AllowMethods` MUST include at least "GET" and "OPTIONS" (for preflight)

**State Transitions**: N/A (static configuration loaded at server startup)

**Relationships**: Used by CORS middleware in `middleware/cors.go`

**Usage**:

- **Development**: `AllowOrigins = ["http://localhost:5173"]`
- **Production**: `AllowOrigins = [process.env.FRONTEND_URL]` (e.g., Vercel domain)

---

### 3. Server Configuration

**Purpose**: Defines runtime parameters for both frontend and backend servers.

**Structure** (Backend - Go):

```go
type ServerConfig struct {
    Port         string  // "8080"
    Host         string  // "localhost" or "0.0.0.0"
    ReadTimeout  int     // Seconds
    WriteTimeout int     // Seconds
}
```

**Structure** (Frontend - TypeScript):

```typescript
interface ServerConfig {
  backendUrl: string; // "http://localhost:8080" or production URL
  port: number; // 5173
}
```

**Validation Rules**:

- `Port` MUST be a valid port number (1-65535)
- `Host` MUST be "localhost", "0.0.0.0", or a valid IP address
- `backendUrl` MUST be a valid HTTP/HTTPS URL

**State Transitions**: N/A (loaded from environment variables at startup)

**Relationships**: None

**Usage**:

- Backend reads from environment variables or defaults
- Frontend reads from `$env/static/private` (SvelteKit env module)

---

## Entity Relationships Diagram

```
N/A - No persistent data models in this feature.
Runtime entities are ephemeral and do not persist beyond request lifecycle.
```

---

## Future Considerations

### Scraping Job Model (Future Feature)

When scraping features are implemented, we'll need:

- **Job Entity**: Represents a scraping task (URL, status, result)
- **Result Entity**: Stores extracted markdown/JSON data
- **Queue Model**: In-memory queue for concurrent scraping

**Note**: Defer data model design until scraping feature specification is created.

---

## Validation Summary

| Entity       | Validation Method            | Implemented In                          |
| ------------ | ---------------------------- | --------------------------------------- |
| HealthStatus | JSON schema validation       | `handlers/health.go` (implicit via Gin) |
| CORSConfig   | Gin middleware validation    | `middleware/cors.go`                    |
| ServerConfig | Go type system + env parsing | `main.go`                               |

---

## Assumptions

1. **No Database**: MVP uses in-memory structures; no persistence layer required for health check
2. **Stateless Endpoints**: Health check does not track request history or aggregate metrics
3. **Environment Variables**: Configuration loaded via `os.Getenv()` with sensible defaults
4. **Type Safety**: TypeScript interfaces ensure frontend contract adherence without runtime validation

---

**Status**: Data model complete. All entities documented. No validation rules violations detected.
